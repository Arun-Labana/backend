
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A 45-day learning plan covering essential backend concepts with beginner-friendly notes and Java examples.">
      
      
      
        <link rel="canonical" href="https://Arun-Labana.github.io/backend/26.%20Leader%20Election/">
      
      
        <link rel="prev" href="../25.%20Distributed%20Locks/">
      
      
        <link rel="next" href="../27.%20Consensus%20Algorithms%20%28Raft%2C%20Paxos%20basics%29/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.18">
    
    
      
        <title>26. Leader Election - 45 Days Backend Concepts</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#leader-election" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="45 Days Backend Concepts" class="md-header__button md-logo" aria-label="45 Days Backend Concepts" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            45 Days Backend Concepts
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              26. Leader Election
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-hidden="true"  type="radio" name="__palette" id="__palette_0">
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/Arun-Labana/backend" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    Arun-Labana/backend
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="45 Days Backend Concepts" class="md-nav__button md-logo" aria-label="45 Days Backend Concepts" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    45 Days Backend Concepts
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Arun-Labana/backend" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    Arun-Labana/backend
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Days
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Days
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01.%20Connection%20Pooling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    01. Connection Pooling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../02.%20Idempotency/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    02. Idempotency
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../03.%20Caching%20%28In-Memory%20vs%20Distributed%29/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    03. Caching (In-Memory vs Distributed)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../04.%20Load%20Balancing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    04. Load Balancing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../05.%20Rate%20Limiting%20%26%20Throttling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    05. Rate Limiting & Throttling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../06.%20Horizontal%20vs%20Vertical%20Scaling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    06. Horizontal vs Vertical Scaling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../07.%20Stateless%20vs%20Stateful%20Architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    07. Stateless vs Stateful Architecture
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../08.%20Transactions%20%28ACID%20properties%29/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    08. Transactions (ACID properties)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../09.%20Indexes%20%28B-Tree%2C%20Hash%2C%20etc.%29/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    09. Indexes (B-Tree, Hash, etc.)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../10.%20Joins%20%26%20Query%20Optimization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    10. Joins & Query Optimization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../11.%20Normalization%20vs%20Denormalization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    11. Normalization vs Denormalization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../12.%20Sharding/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    12. Sharding
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../13.%20Replication/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    13. Replication
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../14.%20CAP%20Theorem/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    14. CAP Theorem
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../15.%20REST%20APIs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    15. REST APIs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../16.%20GraphQL%20Basics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    16. GraphQL Basics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../17.%20gRPC%20%26%20Protocol%20Buffers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    17. gRPC & Protocol Buffers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../18.%20WebSockets%20%28Realtime%20communication%29/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    18. WebSockets (Realtime communication)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../19.%20Message%20Queues%20%28RabbitMQ%2C%20Kafka%2C%20SQS%29/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    19. Message Queues (RabbitMQ, Kafka, SQS)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20.%20Event-driven%20Architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20. Event-driven Architecture
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../21.%20API%20Gateway/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    21. API Gateway
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../22.%20Circuit%20Breaker%20Pattern/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    22. Circuit Breaker Pattern
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../23.%20Retry%20%26%20Backoff%20Strategies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    23. Retry & Backoff Strategies
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../24.%20Dead%20Letter%20Queues/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    24. Dead Letter Queues
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../25.%20Distributed%20Locks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    25. Distributed Locks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    26. Leader Election
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    26. Leader Election
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#what-is-leader-election" class="md-nav__link">
    <span class="md-ellipsis">
      What is Leader Election?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#why-leader-election-is-essential" class="md-nav__link">
    <span class="md-ellipsis">
      Why Leader Election is Essential
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Why Leader Election is Essential">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#avoiding-split-brain-scenarios" class="md-nav__link">
    <span class="md-ellipsis">
      Avoiding Split-Brain Scenarios
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#coordinating-distributed-operations" class="md-nav__link">
    <span class="md-ellipsis">
      Coordinating Distributed Operations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ensuring-single-instance-operations" class="md-nav__link">
    <span class="md-ellipsis">
      Ensuring Single Instance Operations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#providing-system-wide-decision-making" class="md-nav__link">
    <span class="md-ellipsis">
      Providing System-Wide Decision Making
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leader-election-algorithms" class="md-nav__link">
    <span class="md-ellipsis">
      Leader Election Algorithms
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Leader Election Algorithms">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bully-algorithm" class="md-nav__link">
    <span class="md-ellipsis">
      Bully Algorithm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ring-algorithm" class="md-nav__link">
    <span class="md-ellipsis">
      Ring Algorithm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#raft-leader-election" class="md-nav__link">
    <span class="md-ellipsis">
      Raft Leader Election
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zookeeper-leader-election" class="md-nav__link">
    <span class="md-ellipsis">
      ZooKeeper Leader Election
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#real-world-applications" class="md-nav__link">
    <span class="md-ellipsis">
      Real-World Applications
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Real-World Applications">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#database-cluster-management" class="md-nav__link">
    <span class="md-ellipsis">
      Database Cluster Management
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#distributed-task-scheduling" class="md-nav__link">
    <span class="md-ellipsis">
      Distributed Task Scheduling
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microservices-coordination" class="md-nav__link">
    <span class="md-ellipsis">
      Microservices Coordination
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#distributed-caching-systems" class="md-nav__link">
    <span class="md-ellipsis">
      Distributed Caching Systems
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stream-processing-coordination" class="md-nav__link">
    <span class="md-ellipsis">
      Stream Processing Coordination
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple-leader-election-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      Simple Leader Election Implementation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#common-interview-questions" class="md-nav__link">
    <span class="md-ellipsis">
      Common Interview Questions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leader-election-best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      Leader Election Best Practices
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Leader Election Best Practices">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#use-randomized-timeouts" class="md-nav__link">
    <span class="md-ellipsis">
      Use Randomized Timeouts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#implement-proper-failure-detection" class="md-nav__link">
    <span class="md-ellipsis">
      Implement Proper Failure Detection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#handle-network-partitions-gracefully" class="md-nav__link">
    <span class="md-ellipsis">
      Handle Network Partitions Gracefully
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#monitor-election-performance" class="md-nav__link">
    <span class="md-ellipsis">
      Monitor Election Performance
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#design-for-quick-recovery" class="md-nav__link">
    <span class="md-ellipsis">
      Design for Quick Recovery
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#implement-graceful-leadership-transitions" class="md-nav__link">
    <span class="md-ellipsis">
      Implement Graceful Leadership Transitions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../27.%20Consensus%20Algorithms%20%28Raft%2C%20Paxos%20basics%29/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    27. Consensus Algorithms (Raft, Paxos basics)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../28.%20Quorum%20in%20Databases/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    28. Quorum in Databases
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../29.%20Authentication%20vs%20Authorization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    29. Authentication vs Authorization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../30.%20JWT%20%26%20OAuth2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    30. JWT & OAuth2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../31.%20CSRF%20%26%20XSS%20Protection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    31. CSRF & XSS Protection
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../32.%20SQL%20Injection%20%26%20Prevention/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    32. SQL Injection & Prevention
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../33.%20HTTPS%20%26%20TLS/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    33. HTTPS & TLS
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../34.%20CORS%20%28Cross-Origin%20Resource%20Sharing%29/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    34. CORS (Cross-Origin Resource Sharing)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../35.%20Hashing%20%26%20Password%20Storage%20%28bcrypt%2C%20Argon2%29/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    35. Hashing & Password Storage (bcrypt, Argon2)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../36.%20Logging%20Strategies%20%28Structured%20Logging%29/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    36. Logging Strategies (Structured Logging)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../37.%20Metrics%20%26%20Monitoring%20%28Prometheus%2C%20Grafana%29/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    37. Metrics & Monitoring (Prometheus, Grafana)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../38.%20Tracing%20%28Distributed%20Tracing%2C%20OpenTelemetry%29/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    38. Tracing (Distributed Tracing, OpenTelemetry)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../39.%20Health%20Checks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    39. Health Checks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../40.%20Profiling%20%26%20Benchmarking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    40. Profiling & Benchmarking
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../41.%20Error%20Handling%20Patterns/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    41. Error Handling Patterns
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../42.%20Blue-Green%20%26%20Canary%20Deployments/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    42. Blue-Green & Canary Deployments
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../43.%20CQRS%20%28Command%20Query%20Responsibility%20Segregation%29/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    43. CQRS (Command Query Responsibility Segregation)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../44.%20Event%20Sourcing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    44. Event Sourcing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../45.%20Microservices%20vs%20Monoliths%20vs%20Serverless/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    45. Microservices vs Monoliths vs Serverless
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#what-is-leader-election" class="md-nav__link">
    <span class="md-ellipsis">
      What is Leader Election?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#why-leader-election-is-essential" class="md-nav__link">
    <span class="md-ellipsis">
      Why Leader Election is Essential
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Why Leader Election is Essential">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#avoiding-split-brain-scenarios" class="md-nav__link">
    <span class="md-ellipsis">
      Avoiding Split-Brain Scenarios
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#coordinating-distributed-operations" class="md-nav__link">
    <span class="md-ellipsis">
      Coordinating Distributed Operations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ensuring-single-instance-operations" class="md-nav__link">
    <span class="md-ellipsis">
      Ensuring Single Instance Operations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#providing-system-wide-decision-making" class="md-nav__link">
    <span class="md-ellipsis">
      Providing System-Wide Decision Making
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leader-election-algorithms" class="md-nav__link">
    <span class="md-ellipsis">
      Leader Election Algorithms
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Leader Election Algorithms">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bully-algorithm" class="md-nav__link">
    <span class="md-ellipsis">
      Bully Algorithm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ring-algorithm" class="md-nav__link">
    <span class="md-ellipsis">
      Ring Algorithm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#raft-leader-election" class="md-nav__link">
    <span class="md-ellipsis">
      Raft Leader Election
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zookeeper-leader-election" class="md-nav__link">
    <span class="md-ellipsis">
      ZooKeeper Leader Election
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#real-world-applications" class="md-nav__link">
    <span class="md-ellipsis">
      Real-World Applications
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Real-World Applications">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#database-cluster-management" class="md-nav__link">
    <span class="md-ellipsis">
      Database Cluster Management
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#distributed-task-scheduling" class="md-nav__link">
    <span class="md-ellipsis">
      Distributed Task Scheduling
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microservices-coordination" class="md-nav__link">
    <span class="md-ellipsis">
      Microservices Coordination
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#distributed-caching-systems" class="md-nav__link">
    <span class="md-ellipsis">
      Distributed Caching Systems
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stream-processing-coordination" class="md-nav__link">
    <span class="md-ellipsis">
      Stream Processing Coordination
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple-leader-election-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      Simple Leader Election Implementation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#common-interview-questions" class="md-nav__link">
    <span class="md-ellipsis">
      Common Interview Questions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leader-election-best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      Leader Election Best Practices
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Leader Election Best Practices">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#use-randomized-timeouts" class="md-nav__link">
    <span class="md-ellipsis">
      Use Randomized Timeouts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#implement-proper-failure-detection" class="md-nav__link">
    <span class="md-ellipsis">
      Implement Proper Failure Detection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#handle-network-partitions-gracefully" class="md-nav__link">
    <span class="md-ellipsis">
      Handle Network Partitions Gracefully
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#monitor-election-performance" class="md-nav__link">
    <span class="md-ellipsis">
      Monitor Election Performance
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#design-for-quick-recovery" class="md-nav__link">
    <span class="md-ellipsis">
      Design for Quick Recovery
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#implement-graceful-leadership-transitions" class="md-nav__link">
    <span class="md-ellipsis">
      Implement Graceful Leadership Transitions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/Arun-Labana/backend/edit/master/docs/26. Leader Election/README.md" title="Edit this page" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  


<h1 id="leader-election">Leader Election<a class="headerlink" href="#leader-election" title="Permanent link">&para;</a></h1>
<h2 id="what-is-leader-election">What is Leader Election?<a class="headerlink" href="#what-is-leader-election" title="Permanent link">&para;</a></h2>
<p>Leader Election is a distributed systems pattern that designates one node among multiple identical nodes as the "leader" responsible for coordinating activities, making decisions, or managing shared resources while other nodes act as followers. Think of leader election like choosing a team captain in a sports team - while all players are capable and important, having one designated captain helps coordinate plays, make quick decisions during the game, and communicate with referees. Without a clear leader, the team might have conflicting strategies or miss opportunities due to indecision.</p>
<p>In distributed systems, multiple instances of the same service often run simultaneously for high availability and load distribution. However, certain operations should only be performed by one instance at a time to avoid conflicts, data corruption, or duplicate work. Leader election algorithms ensure that exactly one node takes responsibility for these critical operations while providing mechanisms to elect a new leader if the current one fails.</p>
<h2 id="why-leader-election-is-essential">Why Leader Election is Essential<a class="headerlink" href="#why-leader-election-is-essential" title="Permanent link">&para;</a></h2>
<h3 id="avoiding-split-brain-scenarios">Avoiding Split-Brain Scenarios<a class="headerlink" href="#avoiding-split-brain-scenarios" title="Permanent link">&para;</a></h3>
<p>Split-brain scenarios occur when multiple nodes believe they are the leader simultaneously, leading to conflicting decisions and potential data corruption. This can happen due to network partitions, where different groups of nodes lose communication with each other and each group elects its own leader.</p>
<p>Leader election algorithms are designed to prevent split-brain scenarios by ensuring that only one leader can exist at any given time, even during network partitions. They use various techniques like quorums, consensus mechanisms, and careful timing to maintain this guarantee.</p>
<h3 id="coordinating-distributed-operations">Coordinating Distributed Operations<a class="headerlink" href="#coordinating-distributed-operations" title="Permanent link">&para;</a></h3>
<p>Many distributed operations require coordination and sequencing that's best handled by a single coordinator. Examples include distributed transactions, resource allocation, task scheduling, and maintaining global state consistency. Having a designated leader simplifies these operations by providing a single point of decision-making.</p>
<p>Without a leader, these operations would require complex peer-to-peer coordination protocols that are often more difficult to implement correctly and reason about than centralized coordination through an elected leader.</p>
<h3 id="ensuring-single-instance-operations">Ensuring Single Instance Operations<a class="headerlink" href="#ensuring-single-instance-operations" title="Permanent link">&para;</a></h3>
<p>Certain operations should only be performed by one instance in a distributed system, such as scheduled maintenance tasks, data backups, report generation, or external API integrations with rate limits. Leader election ensures that these operations are performed by exactly one node, preventing duplication of work and potential conflicts.</p>
<h3 id="providing-system-wide-decision-making">Providing System-Wide Decision Making<a class="headerlink" href="#providing-system-wide-decision-making" title="Permanent link">&para;</a></h3>
<p>Distributed systems often need to make system-wide decisions like scaling policies, configuration changes, or failover procedures. Having an elected leader provides a clear decision-making authority that can evaluate system state and make coordinated decisions on behalf of the entire cluster.</p>
<h2 id="leader-election-algorithms">Leader Election Algorithms<a class="headerlink" href="#leader-election-algorithms" title="Permanent link">&para;</a></h2>
<h3 id="bully-algorithm">Bully Algorithm<a class="headerlink" href="#bully-algorithm" title="Permanent link">&para;</a></h3>
<p>The Bully Algorithm is one of the simplest leader election algorithms where nodes are assigned unique identifiers, and the node with the highest ID becomes the leader. When a node detects that the current leader has failed, it initiates an election by sending election messages to all nodes with higher IDs.</p>
<p>If no higher-ID node responds within a timeout period, the initiating node declares itself the leader and notifies all other nodes. If a higher-ID node responds, it takes over the election process. The algorithm is called "bully" because higher-ID nodes can override lower-ID nodes' election attempts.</p>
<p>While simple to understand and implement, the Bully Algorithm can generate significant network traffic during elections and may not handle network partitions gracefully.</p>
<h3 id="ring-algorithm">Ring Algorithm<a class="headerlink" href="#ring-algorithm" title="Permanent link">&para;</a></h3>
<p>The Ring Algorithm organizes nodes in a logical ring structure where each node knows its successor in the ring. When an election is needed, a node sends an election message around the ring, and each node adds its ID to the message before forwarding it.</p>
<p>When the message completes the ring and returns to the initiator, it contains all active node IDs. The node with the highest ID (or based on some other criteria) is elected as the leader, and a coordinator message is sent around the ring to announce the new leader.</p>
<p>The Ring Algorithm generates less network traffic than the Bully Algorithm but can be slower to complete elections, especially in large rings.</p>
<h3 id="raft-leader-election">Raft Leader Election<a class="headerlink" href="#raft-leader-election" title="Permanent link">&para;</a></h3>
<p>Raft is a consensus algorithm that includes a sophisticated leader election mechanism designed for reliability and understandability. In Raft, nodes can be in one of three states: leader, follower, or candidate. Elections are triggered by timeouts, and candidates request votes from other nodes.</p>
<p>A candidate becomes leader if it receives votes from a majority of nodes. Raft uses randomized election timeouts to reduce the likelihood of split votes and includes mechanisms to handle network partitions and ensure safety properties.</p>
<p>Raft's leader election is more complex than simpler algorithms but provides strong consistency guarantees and is well-suited for systems requiring high reliability.</p>
<h3 id="zookeeper-leader-election">ZooKeeper Leader Election<a class="headerlink" href="#zookeeper-leader-election" title="Permanent link">&para;</a></h3>
<p>Apache ZooKeeper provides built-in leader election capabilities using ephemeral sequential nodes. Nodes create ephemeral sequential znodes in a designated path, and the node with the lowest sequence number becomes the leader.</p>
<p>When the leader fails, its ephemeral node is automatically deleted, and the node with the next lowest sequence number becomes the new leader. This approach is simple, reliable, and handles failures gracefully through ZooKeeper's built-in mechanisms.</p>
<h2 id="real-world-applications">Real-World Applications<a class="headerlink" href="#real-world-applications" title="Permanent link">&para;</a></h2>
<h3 id="database-cluster-management">Database Cluster Management<a class="headerlink" href="#database-cluster-management" title="Permanent link">&para;</a></h3>
<p>Database clusters often use leader election to designate a primary node responsible for handling write operations while other nodes serve as read replicas. The leader coordinates replication, handles schema changes, and manages cluster membership.</p>
<p>For example, in a PostgreSQL cluster with streaming replication, one node is elected as the primary (leader) that accepts write operations and streams changes to standby nodes. If the primary fails, leader election algorithms help promote one of the standbys to become the new primary.</p>
<h3 id="distributed-task-scheduling">Distributed Task Scheduling<a class="headerlink" href="#distributed-task-scheduling" title="Permanent link">&para;</a></h3>
<p>Task scheduling systems use leader election to ensure that scheduled jobs run exactly once across a cluster of scheduler instances. The elected leader is responsible for triggering scheduled tasks, while follower nodes remain ready to take over if the leader fails.</p>
<p>Systems like Apache Airflow or Kubernetes CronJobs use leader election to coordinate task execution across multiple scheduler instances, preventing duplicate job executions while maintaining high availability.</p>
<h3 id="microservices-coordination">Microservices Coordination<a class="headerlink" href="#microservices-coordination" title="Permanent link">&para;</a></h3>
<p>In microservices architectures, certain coordination tasks like service discovery updates, configuration management, or cross-service orchestration are best handled by a single coordinator. Leader election designates which service instance handles these responsibilities.</p>
<p>For example, in a service mesh, one instance might be elected as the leader responsible for updating routing configurations, managing certificates, or coordinating rolling updates across the mesh.</p>
<h3 id="distributed-caching-systems">Distributed Caching Systems<a class="headerlink" href="#distributed-caching-systems" title="Permanent link">&para;</a></h3>
<p>Distributed caching systems use leader election to coordinate cache invalidation, data distribution, and cluster membership changes. The leader manages the consistent hashing ring, handles node additions and removals, and coordinates data rebalancing.</p>
<p>Redis Cluster, for instance, uses a form of leader election where each shard has a master node (leader) responsible for handling writes and coordinating with replica nodes.</p>
<h3 id="stream-processing-coordination">Stream Processing Coordination<a class="headerlink" href="#stream-processing-coordination" title="Permanent link">&para;</a></h3>
<p>Stream processing systems like Apache Kafka use leader election to designate partition leaders responsible for handling reads and writes for specific data partitions. The leader coordinates replication to follower replicas and handles client requests.</p>
<p>When a partition leader fails, the remaining replicas participate in leader election to choose a new leader, ensuring continuous availability of the partition while maintaining data consistency.</p>
<h2 id="simple-leader-election-implementation">Simple Leader Election Implementation<a class="headerlink" href="#simple-leader-election-implementation" title="Permanent link">&para;</a></h2>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">threading</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">random</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">uuid</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Set</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">enum</span><span class="w"> </span><span class="kn">import</span> <span class="n">Enum</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>

<span class="k">class</span><span class="w"> </span><span class="nc">NodeState</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="n">FOLLOWER</span> <span class="o">=</span> <span class="s2">&quot;follower&quot;</span>
    <span class="n">CANDIDATE</span> <span class="o">=</span> <span class="s2">&quot;candidate&quot;</span>
    <span class="n">LEADER</span> <span class="o">=</span> <span class="s2">&quot;leader&quot;</span>

<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Node</span><span class="p">:</span>
    <span class="n">node_id</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">priority</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">last_heartbeat</span><span class="p">:</span> <span class="n">datetime</span>
    <span class="n">state</span><span class="p">:</span> <span class="n">NodeState</span> <span class="o">=</span> <span class="n">NodeState</span><span class="o">.</span><span class="n">FOLLOWER</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">is_alive</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timeout_seconds</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_heartbeat</span> <span class="o">&lt;</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">timeout_seconds</span><span class="p">)</span>

<span class="k">class</span><span class="w"> </span><span class="nc">LeaderElection</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">priority</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">node_id</span> <span class="o">=</span> <span class="n">node_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">priority</span> <span class="o">=</span> <span class="n">priority</span> <span class="ow">or</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">NodeState</span><span class="o">.</span><span class="n">FOLLOWER</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_leader</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Node</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">election_timeout</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>  <span class="c1"># Randomized timeout</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">heartbeat_interval</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">last_heartbeat_received</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">running</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lock</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>

        <span class="c1"># Add self to nodes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">node_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span>
            <span class="n">node_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">node_id</span><span class="p">,</span>
            <span class="n">priority</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">priority</span><span class="p">,</span>
            <span class="n">last_heartbeat</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(),</span>
            <span class="n">state</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Start the leader election process&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">running</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">heartbeat_thread</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_heartbeat_loop</span><span class="p">,</span> <span class="n">daemon</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">election_thread</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_election_loop</span><span class="p">,</span> <span class="n">daemon</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">heartbeat_thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">election_thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Node </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">node_id</span><span class="si">}</span><span class="s2"> started with priority </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">priority</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Stop the leader election process&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">running</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;heartbeat_thread&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">heartbeat_thread</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;election_thread&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">election_thread</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">priority</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a new node to the cluster&quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">lock</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span>
                <span class="n">node_id</span><span class="o">=</span><span class="n">node_id</span><span class="p">,</span>
                <span class="n">priority</span><span class="o">=</span><span class="n">priority</span><span class="p">,</span>
                <span class="n">last_heartbeat</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(),</span>
                <span class="n">state</span><span class="o">=</span><span class="n">NodeState</span><span class="o">.</span><span class="n">FOLLOWER</span>
            <span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Added node </span><span class="si">{</span><span class="n">node_id</span><span class="si">}</span><span class="s2"> with priority </span><span class="si">{</span><span class="n">priority</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">receive_heartbeat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">leader_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Receive heartbeat from current leader&quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">lock</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">leader_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">leader_id</span><span class="p">]</span><span class="o">.</span><span class="n">last_heartbeat</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">leader_id</span><span class="p">]</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">NodeState</span><span class="o">.</span><span class="n">LEADER</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_leader</span> <span class="o">!=</span> <span class="n">leader_id</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">current_leader</span> <span class="o">=</span> <span class="n">leader_id</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Node </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">node_id</span><span class="si">}</span><span class="s2">: Acknowledged </span><span class="si">{</span><span class="n">leader_id</span><span class="si">}</span><span class="s2"> as leader&quot;</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">last_heartbeat_received</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>

                <span class="c1"># If we were a candidate or leader, step down</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">!=</span> <span class="n">NodeState</span><span class="o">.</span><span class="n">FOLLOWER</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">NodeState</span><span class="o">.</span><span class="n">FOLLOWER</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">node_id</span><span class="p">]</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">NodeState</span><span class="o">.</span><span class="n">FOLLOWER</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">receive_election_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">candidate_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">candidate_priority</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Receive election request from a candidate&quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">lock</span><span class="p">:</span>
            <span class="c1"># Vote for candidate if they have higher priority or if we haven&#39;t voted yet</span>
            <span class="k">if</span> <span class="n">candidate_priority</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">priority</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Node </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">node_id</span><span class="si">}</span><span class="s2">: Voting for </span><span class="si">{</span><span class="n">candidate_id</span><span class="si">}</span><span class="s2"> (higher priority)&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">True</span>
            <span class="k">elif</span> <span class="n">candidate_priority</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">priority</span> <span class="ow">and</span> <span class="n">candidate_id</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">node_id</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Node </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">node_id</span><span class="si">}</span><span class="s2">: Voting for </span><span class="si">{</span><span class="n">candidate_id</span><span class="si">}</span><span class="s2"> (tie-breaker)&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Node </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">node_id</span><span class="si">}</span><span class="s2">: Not voting for </span><span class="si">{</span><span class="n">candidate_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_heartbeat_loop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Send heartbeats if we are the leader&quot;&quot;&quot;</span>
        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">running</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">==</span> <span class="n">NodeState</span><span class="o">.</span><span class="n">LEADER</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_send_heartbeat</span><span class="p">()</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">heartbeat_interval</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_send_heartbeat</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Send heartbeat to all followers&quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">lock</span><span class="p">:</span>
            <span class="n">alive_followers</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">node</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> 
                <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">node_id</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">node_id</span> <span class="ow">and</span> <span class="n">node</span><span class="o">.</span><span class="n">is_alive</span><span class="p">()</span>
            <span class="p">]</span>

            <span class="k">if</span> <span class="n">alive_followers</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Leader </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">node_id</span><span class="si">}</span><span class="s2">: Sending heartbeat to </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">alive_followers</span><span class="p">)</span><span class="si">}</span><span class="s2"> followers&quot;</span><span class="p">)</span>
                <span class="c1"># In a real implementation, this would send network messages</span>
                <span class="c1"># Here we simulate by updating our own records</span>
                <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">alive_followers</span><span class="p">:</span>
                    <span class="c1"># Simulate followers receiving heartbeat</span>
                    <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_election_loop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Monitor for leader failures and initiate elections&quot;&quot;&quot;</span>
        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">running</span><span class="p">:</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">lock</span><span class="p">:</span>
                <span class="c1"># Check if we need to start an election</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_should_start_election</span><span class="p">():</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_start_election</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_should_start_election</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Determine if we should start an election&quot;&quot;&quot;</span>
        <span class="c1"># Start election if no leader or leader hasn&#39;t sent heartbeat recently</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">==</span> <span class="n">NodeState</span><span class="o">.</span><span class="n">FOLLOWER</span><span class="p">:</span>
            <span class="n">time_since_heartbeat</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_heartbeat_received</span>
            <span class="k">return</span> <span class="n">time_since_heartbeat</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">election_timeout</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_start_election</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Start a new leader election&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">NodeState</span><span class="o">.</span><span class="n">CANDIDATE</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">node_id</span><span class="p">]</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">NodeState</span><span class="o">.</span><span class="n">CANDIDATE</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Node </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">node_id</span><span class="si">}</span><span class="s2">: Starting election (priority </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">priority</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

        <span class="c1"># Count votes (including our own)</span>
        <span class="n">votes</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">total_nodes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">([</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">if</span> <span class="n">n</span><span class="o">.</span><span class="n">is_alive</span><span class="p">()])</span>

        <span class="c1"># Request votes from other nodes</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">node_id</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">node_id</span> <span class="ow">and</span> <span class="n">node</span><span class="o">.</span><span class="n">is_alive</span><span class="p">():</span>
                <span class="c1"># Simulate vote request</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_simulate_vote_request</span><span class="p">(</span><span class="n">node</span><span class="p">):</span>
                    <span class="n">votes</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Node </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">node_id</span><span class="si">}</span><span class="s2">: Received </span><span class="si">{</span><span class="n">votes</span><span class="si">}</span><span class="s2"> votes out of </span><span class="si">{</span><span class="n">total_nodes</span><span class="si">}</span><span class="s2"> nodes&quot;</span><span class="p">)</span>

        <span class="c1"># Check if we won the election (majority)</span>
        <span class="k">if</span> <span class="n">votes</span> <span class="o">&gt;</span> <span class="n">total_nodes</span> <span class="o">//</span> <span class="mi">2</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_become_leader</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Election failed, go back to follower</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">NodeState</span><span class="o">.</span><span class="n">FOLLOWER</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">node_id</span><span class="p">]</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">NodeState</span><span class="o">.</span><span class="n">FOLLOWER</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Node </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">node_id</span><span class="si">}</span><span class="s2">: Election failed, returning to follower state&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_simulate_vote_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">Node</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Simulate requesting a vote from another node&quot;&quot;&quot;</span>
        <span class="c1"># In a real implementation, this would send a network request</span>
        <span class="c1"># Here we simulate based on priority comparison</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">priority</span> <span class="o">&gt;</span> <span class="n">node</span><span class="o">.</span><span class="n">priority</span> <span class="ow">or</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">priority</span> <span class="o">==</span> <span class="n">node</span><span class="o">.</span><span class="n">priority</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">node_id</span> <span class="o">&gt;</span> <span class="n">node</span><span class="o">.</span><span class="n">node_id</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_become_leader</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Become the cluster leader&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">NodeState</span><span class="o">.</span><span class="n">LEADER</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_leader</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">node_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">node_id</span><span class="p">]</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">NodeState</span><span class="o">.</span><span class="n">LEADER</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Node </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">node_id</span><span class="si">}</span><span class="s2">: ELECTED AS LEADER!&quot;</span><span class="p">)</span>

        <span class="c1"># Mark other nodes as followers</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">node_id</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">node_id</span><span class="p">:</span>
                <span class="n">node</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">NodeState</span><span class="o">.</span><span class="n">FOLLOWER</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_cluster_status</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get current cluster status&quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">lock</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{</span>
                <span class="s1">&#39;node_id&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">node_id</span><span class="p">,</span>
                <span class="s1">&#39;state&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                <span class="s1">&#39;current_leader&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_leader</span><span class="p">,</span>
                <span class="s1">&#39;nodes&#39;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="n">node_id</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s1">&#39;priority&#39;</span><span class="p">:</span> <span class="n">node</span><span class="o">.</span><span class="n">priority</span><span class="p">,</span>
                        <span class="s1">&#39;state&#39;</span><span class="p">:</span> <span class="n">node</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                        <span class="s1">&#39;alive&#39;</span><span class="p">:</span> <span class="n">node</span><span class="o">.</span><span class="n">is_alive</span><span class="p">()</span>
                    <span class="p">}</span>
                    <span class="k">for</span> <span class="n">node_id</span><span class="p">,</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                <span class="p">}</span>
            <span class="p">}</span>

<span class="c1"># Demonstration of leader election</span>
<span class="k">def</span><span class="w"> </span><span class="nf">demo_leader_election</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== Leader Election Demonstration ===&quot;</span><span class="p">)</span>

    <span class="c1"># Create multiple nodes with different priorities</span>
    <span class="n">nodes</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">node_configs</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="s2">&quot;node-1&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>
        <span class="p">(</span><span class="s2">&quot;node-2&quot;</span><span class="p">,</span> <span class="mi">200</span><span class="p">),</span> 
        <span class="p">(</span><span class="s2">&quot;node-3&quot;</span><span class="p">,</span> <span class="mi">150</span><span class="p">),</span>
        <span class="p">(</span><span class="s2">&quot;node-4&quot;</span><span class="p">,</span> <span class="mi">250</span><span class="p">)</span>
    <span class="p">]</span>

    <span class="c1"># Initialize nodes</span>
    <span class="k">for</span> <span class="n">node_id</span><span class="p">,</span> <span class="n">priority</span> <span class="ow">in</span> <span class="n">node_configs</span><span class="p">:</span>
        <span class="n">node</span> <span class="o">=</span> <span class="n">LeaderElection</span><span class="p">(</span><span class="n">node_id</span><span class="p">,</span> <span class="n">priority</span><span class="p">)</span>
        <span class="n">nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>

    <span class="c1"># Add all nodes to each other&#39;s knowledge</span>
    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">other_id</span><span class="p">,</span> <span class="n">other_priority</span> <span class="ow">in</span> <span class="n">node_configs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">other_id</span> <span class="o">!=</span> <span class="n">node</span><span class="o">.</span><span class="n">node_id</span><span class="p">:</span>
                <span class="n">node</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">other_id</span><span class="p">,</span> <span class="n">other_priority</span><span class="p">)</span>

    <span class="c1"># Start all nodes</span>
    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">:</span>
        <span class="n">node</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">=== Initial Election ===&quot;</span><span class="p">)</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>  <span class="c1"># Let initial election complete</span>

    <span class="c1"># Show cluster status</span>
    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">:</span>
        <span class="n">status</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">get_cluster_status</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">node</span><span class="o">.</span><span class="n">node_id</span><span class="si">}</span><span class="s2">: State=</span><span class="si">{</span><span class="n">status</span><span class="p">[</span><span class="s1">&#39;state&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">, Leader=</span><span class="si">{</span><span class="n">status</span><span class="p">[</span><span class="s1">&#39;current_leader&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">=== Simulating Leader Failure ===&quot;</span><span class="p">)</span>
    <span class="c1"># Find and stop the current leader</span>
    <span class="n">current_leader</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">state</span> <span class="o">==</span> <span class="n">NodeState</span><span class="o">.</span><span class="n">LEADER</span><span class="p">:</span>
            <span class="n">current_leader</span> <span class="o">=</span> <span class="n">node</span>
            <span class="k">break</span>

    <span class="k">if</span> <span class="n">current_leader</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stopping leader: </span><span class="si">{</span><span class="n">current_leader</span><span class="o">.</span><span class="n">node_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">current_leader</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
        <span class="n">nodes</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">current_leader</span><span class="p">)</span>

        <span class="c1"># Wait for new election</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">=== After Leader Failure ===&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">:</span>
            <span class="n">status</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">get_cluster_status</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">node</span><span class="o">.</span><span class="n">node_id</span><span class="si">}</span><span class="s2">: State=</span><span class="si">{</span><span class="n">status</span><span class="p">[</span><span class="s1">&#39;state&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">, Leader=</span><span class="si">{</span><span class="n">status</span><span class="p">[</span><span class="s1">&#39;current_leader&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Clean up</span>
    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">:</span>
        <span class="n">node</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">demo_leader_election</span><span class="p">()</span>
</code></pre></div>

<h2 id="common-interview-questions">Common Interview Questions<a class="headerlink" href="#common-interview-questions" title="Permanent link">&para;</a></h2>
<p><strong>Q: What is leader election and why is it necessary in distributed systems?</strong></p>
<p>Leader election is a process where distributed nodes coordinate to designate exactly one node as the leader responsible for making decisions and coordinating activities. It's necessary because many operations in distributed systems require coordination (like distributed transactions, resource allocation, task scheduling), certain tasks should only be performed by one instance (scheduled jobs, backups), split-brain scenarios must be prevented (multiple leaders causing conflicts), and having a single decision-maker simplifies complex coordination problems. Without leader election, systems would need complex peer-to-peer coordination or risk data corruption from conflicting operations.</p>
<p><strong>Q: What are the main challenges in implementing leader election algorithms?</strong></p>
<p>Key challenges include: split-brain prevention (ensuring only one leader exists even during network partitions), network partition handling (maintaining availability while preserving safety), failure detection (determining when a leader has actually failed vs. experiencing network delays), election convergence (ensuring elections complete in reasonable time), performance impact (minimizing overhead of election processes), and timing issues (handling clock skew and network delays). The fundamental challenge is balancing safety (never having multiple leaders) with liveness (always having a leader available).</p>
<p><strong>Q: Compare different leader election algorithms and their trade-offs.</strong></p>
<p>Bully Algorithm: Simple, uses node priorities, but generates high network traffic and doesn't handle partitions well. Ring Algorithm: Lower network overhead, but slower elections and single point of failure in ring structure. Raft: Strong consistency guarantees, handles partitions well, but more complex implementation. ZooKeeper-based: Reliable and battle-tested, but requires external dependency. The choice depends on consistency requirements (strong vs. eventual), network characteristics (reliable vs. unreliable), implementation complexity tolerance, and existing infrastructure (whether you already have consensus systems available).</p>
<p><strong>Q: How do you handle network partitions in leader election?</strong></p>
<p>Handle partitions through: quorum-based decisions (require majority votes to elect leaders), split-brain detection (use external arbitrators or shared storage), graceful degradation (read-only mode when no leader available), partition healing (automatic re-election when partitions merge), and timeout tuning (balance between false positives and detection speed). The key principle is that it's better to have no leader than multiple leaders, so systems should err on the side of caution during uncertain network conditions. Some systems use techniques like STONITH (Shoot The Other Node In The Head) for definitive conflict resolution.</p>
<h2 id="leader-election-best-practices">Leader Election Best Practices<a class="headerlink" href="#leader-election-best-practices" title="Permanent link">&para;</a></h2>
<h3 id="use-randomized-timeouts">Use Randomized Timeouts<a class="headerlink" href="#use-randomized-timeouts" title="Permanent link">&para;</a></h3>
<p>Implement randomized election timeouts to prevent multiple nodes from starting elections simultaneously, which can lead to split votes and election failures. Random timeouts help stagger election attempts and improve convergence probability.</p>
<h3 id="implement-proper-failure-detection">Implement Proper Failure Detection<a class="headerlink" href="#implement-proper-failure-detection" title="Permanent link">&para;</a></h3>
<p>Design robust failure detection mechanisms that can distinguish between actual node failures and temporary network issues. Use multiple detection methods like heartbeats, health checks, and external monitoring to make accurate failure determinations.</p>
<h3 id="handle-network-partitions-gracefully">Handle Network Partitions Gracefully<a class="headerlink" href="#handle-network-partitions-gracefully" title="Permanent link">&para;</a></h3>
<p>Design your system to handle network partitions safely by requiring quorum for leader election and implementing read-only modes when leadership is uncertain. Prioritize safety over availability when in doubt about network conditions.</p>
<h3 id="monitor-election-performance">Monitor Election Performance<a class="headerlink" href="#monitor-election-performance" title="Permanent link">&para;</a></h3>
<p>Track election frequency, duration, and success rates to identify issues with your election algorithm or network conditions. Frequent elections might indicate problems with failure detection sensitivity or network stability.</p>
<h3 id="design-for-quick-recovery">Design for Quick Recovery<a class="headerlink" href="#design-for-quick-recovery" title="Permanent link">&para;</a></h3>
<p>Minimize the time between leader failure detection and new leader election to reduce system downtime. However, balance this with the need to avoid false positives that could cause unnecessary leadership changes.</p>
<h3 id="implement-graceful-leadership-transitions">Implement Graceful Leadership Transitions<a class="headerlink" href="#implement-graceful-leadership-transitions" title="Permanent link">&para;</a></h3>
<p>Design smooth handover processes when leadership changes, ensuring that ongoing operations are properly transferred or safely aborted. Consider implementing leadership transfer mechanisms for planned maintenance.</p>
<p>Leader election is a fundamental building block for many distributed system patterns. When implemented correctly, it provides the coordination foundation that enables complex distributed operations while maintaining system consistency and availability. The key is choosing the right algorithm for your specific requirements and implementing it with proper attention to failure scenarios and network realities.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["navigation.instant", "navigation.sections", "navigation.tracking", "content.code.copy", "content.action.edit", "search.suggest", "search.highlight"], "search": "../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.92b07e13.min.js"></script>
      
    
  </body>
</html>