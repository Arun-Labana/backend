
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A 45-day learning plan covering essential backend concepts with beginner-friendly notes and Java examples.">
      
      
      
        <link rel="canonical" href="https://Arun-Labana.github.io/backend/29.%20Authentication%20vs%20Authorization/">
      
      
        <link rel="prev" href="../28.%20Quorum%20in%20Databases/">
      
      
        <link rel="next" href="../30.%20JWT%20%26%20OAuth2/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.18">
    
    
      
        <title>29. Authentication vs Authorization - 45 Days Backend Concepts</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#authentication-vs-authorization" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="45 Days Backend Concepts" class="md-header__button md-logo" aria-label="45 Days Backend Concepts" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            45 Days Backend Concepts
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              29. Authentication vs Authorization
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-hidden="true"  type="radio" name="__palette" id="__palette_0">
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/Arun-Labana/backend" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    Arun-Labana/backend
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="45 Days Backend Concepts" class="md-nav__button md-logo" aria-label="45 Days Backend Concepts" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    45 Days Backend Concepts
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Arun-Labana/backend" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    Arun-Labana/backend
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Days
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Days
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01.%20Connection%20Pooling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    01. Connection Pooling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../02.%20Idempotency/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    02. Idempotency
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../03.%20Caching%20%28In-Memory%20vs%20Distributed%29/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    03. Caching (In-Memory vs Distributed)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../04.%20Load%20Balancing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    04. Load Balancing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../05.%20Rate%20Limiting%20%26%20Throttling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    05. Rate Limiting & Throttling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../06.%20Horizontal%20vs%20Vertical%20Scaling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    06. Horizontal vs Vertical Scaling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../07.%20Stateless%20vs%20Stateful%20Architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    07. Stateless vs Stateful Architecture
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../08.%20Transactions%20%28ACID%20properties%29/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    08. Transactions (ACID properties)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../09.%20Indexes%20%28B-Tree%2C%20Hash%2C%20etc.%29/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    09. Indexes (B-Tree, Hash, etc.)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../10.%20Joins%20%26%20Query%20Optimization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    10. Joins & Query Optimization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../11.%20Normalization%20vs%20Denormalization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    11. Normalization vs Denormalization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../12.%20Sharding/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    12. Sharding
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../13.%20Replication/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    13. Replication
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../14.%20CAP%20Theorem/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    14. CAP Theorem
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../15.%20REST%20APIs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    15. REST APIs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../16.%20GraphQL%20Basics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    16. GraphQL Basics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../17.%20gRPC%20%26%20Protocol%20Buffers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    17. gRPC & Protocol Buffers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../18.%20WebSockets%20%28Realtime%20communication%29/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    18. WebSockets (Realtime communication)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../19.%20Message%20Queues%20%28RabbitMQ%2C%20Kafka%2C%20SQS%29/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    19. Message Queues (RabbitMQ, Kafka, SQS)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20.%20Event-driven%20Architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20. Event-driven Architecture
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../21.%20API%20Gateway/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    21. API Gateway
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../22.%20Circuit%20Breaker%20Pattern/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    22. Circuit Breaker Pattern
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../23.%20Retry%20%26%20Backoff%20Strategies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    23. Retry & Backoff Strategies
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../24.%20Dead%20Letter%20Queues/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    24. Dead Letter Queues
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../25.%20Distributed%20Locks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    25. Distributed Locks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../26.%20Leader%20Election/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    26. Leader Election
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../27.%20Consensus%20Algorithms%20%28Raft%2C%20Paxos%20basics%29/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    27. Consensus Algorithms (Raft, Paxos basics)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../28.%20Quorum%20in%20Databases/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    28. Quorum in Databases
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    29. Authentication vs Authorization
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    29. Authentication vs Authorization
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#what-are-authentication-and-authorization" class="md-nav__link">
    <span class="md-ellipsis">
      What are Authentication and Authorization?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#authentication-proving-identity" class="md-nav__link">
    <span class="md-ellipsis">
      Authentication: Proving Identity
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Authentication: Proving Identity">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-authentication-accomplishes" class="md-nav__link">
    <span class="md-ellipsis">
      What Authentication Accomplishes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#types-of-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      Types of Authentication
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#authentication-challenges" class="md-nav__link">
    <span class="md-ellipsis">
      Authentication Challenges
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#authorization-controlling-access" class="md-nav__link">
    <span class="md-ellipsis">
      Authorization: Controlling Access
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Authorization: Controlling Access">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-authorization-accomplishes" class="md-nav__link">
    <span class="md-ellipsis">
      What Authorization Accomplishes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#authorization-models" class="md-nav__link">
    <span class="md-ellipsis">
      Authorization Models
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#authorization-enforcement" class="md-nav__link">
    <span class="md-ellipsis">
      Authorization Enforcement
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-relationship-between-authentication-and-authorization" class="md-nav__link">
    <span class="md-ellipsis">
      The Relationship Between Authentication and Authorization
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The Relationship Between Authentication and Authorization">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sequential-dependency" class="md-nav__link">
    <span class="md-ellipsis">
      Sequential Dependency
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#token-based-integration" class="md-nav__link">
    <span class="md-ellipsis">
      Token-Based Integration
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#real-world-applications" class="md-nav__link">
    <span class="md-ellipsis">
      Real-World Applications
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Real-World Applications">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#enterprise-applications" class="md-nav__link">
    <span class="md-ellipsis">
      Enterprise Applications
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cloud-platforms" class="md-nav__link">
    <span class="md-ellipsis">
      Cloud Platforms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#api-security" class="md-nav__link">
    <span class="md-ellipsis">
      API Security
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microservices-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      Microservices Architecture
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple-authentication-and-authorization-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      Simple Authentication and Authorization Implementation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#common-interview-questions" class="md-nav__link">
    <span class="md-ellipsis">
      Common Interview Questions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#authentication-and-authorization-best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      Authentication and Authorization Best Practices
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Authentication and Authorization Best Practices">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#implement-defense-in-depth" class="md-nav__link">
    <span class="md-ellipsis">
      Implement Defense in Depth
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#follow-the-principle-of-least-privilege" class="md-nav__link">
    <span class="md-ellipsis">
      Follow the Principle of Least Privilege
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#secure-token-management" class="md-nav__link">
    <span class="md-ellipsis">
      Secure Token Management
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#implement-comprehensive-auditing" class="md-nav__link">
    <span class="md-ellipsis">
      Implement Comprehensive Auditing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#plan-for-scalability-and-performance" class="md-nav__link">
    <span class="md-ellipsis">
      Plan for Scalability and Performance
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#regular-security-reviews" class="md-nav__link">
    <span class="md-ellipsis">
      Regular Security Reviews
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../30.%20JWT%20%26%20OAuth2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    30. JWT & OAuth2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../31.%20CSRF%20%26%20XSS%20Protection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    31. CSRF & XSS Protection
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../32.%20SQL%20Injection%20%26%20Prevention/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    32. SQL Injection & Prevention
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../33.%20HTTPS%20%26%20TLS/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    33. HTTPS & TLS
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../34.%20CORS%20%28Cross-Origin%20Resource%20Sharing%29/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    34. CORS (Cross-Origin Resource Sharing)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../35.%20Hashing%20%26%20Password%20Storage%20%28bcrypt%2C%20Argon2%29/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    35. Hashing & Password Storage (bcrypt, Argon2)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../36.%20Logging%20Strategies%20%28Structured%20Logging%29/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    36. Logging Strategies (Structured Logging)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../37.%20Metrics%20%26%20Monitoring%20%28Prometheus%2C%20Grafana%29/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    37. Metrics & Monitoring (Prometheus, Grafana)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../38.%20Tracing%20%28Distributed%20Tracing%2C%20OpenTelemetry%29/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    38. Tracing (Distributed Tracing, OpenTelemetry)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../39.%20Health%20Checks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    39. Health Checks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../40.%20Profiling%20%26%20Benchmarking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    40. Profiling & Benchmarking
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../41.%20Error%20Handling%20Patterns/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    41. Error Handling Patterns
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../42.%20Blue-Green%20%26%20Canary%20Deployments/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    42. Blue-Green & Canary Deployments
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../43.%20CQRS%20%28Command%20Query%20Responsibility%20Segregation%29/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    43. CQRS (Command Query Responsibility Segregation)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../44.%20Event%20Sourcing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    44. Event Sourcing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../45.%20Microservices%20vs%20Monoliths%20vs%20Serverless/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    45. Microservices vs Monoliths vs Serverless
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#what-are-authentication-and-authorization" class="md-nav__link">
    <span class="md-ellipsis">
      What are Authentication and Authorization?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#authentication-proving-identity" class="md-nav__link">
    <span class="md-ellipsis">
      Authentication: Proving Identity
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Authentication: Proving Identity">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-authentication-accomplishes" class="md-nav__link">
    <span class="md-ellipsis">
      What Authentication Accomplishes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#types-of-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      Types of Authentication
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#authentication-challenges" class="md-nav__link">
    <span class="md-ellipsis">
      Authentication Challenges
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#authorization-controlling-access" class="md-nav__link">
    <span class="md-ellipsis">
      Authorization: Controlling Access
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Authorization: Controlling Access">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-authorization-accomplishes" class="md-nav__link">
    <span class="md-ellipsis">
      What Authorization Accomplishes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#authorization-models" class="md-nav__link">
    <span class="md-ellipsis">
      Authorization Models
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#authorization-enforcement" class="md-nav__link">
    <span class="md-ellipsis">
      Authorization Enforcement
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-relationship-between-authentication-and-authorization" class="md-nav__link">
    <span class="md-ellipsis">
      The Relationship Between Authentication and Authorization
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The Relationship Between Authentication and Authorization">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sequential-dependency" class="md-nav__link">
    <span class="md-ellipsis">
      Sequential Dependency
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#token-based-integration" class="md-nav__link">
    <span class="md-ellipsis">
      Token-Based Integration
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#real-world-applications" class="md-nav__link">
    <span class="md-ellipsis">
      Real-World Applications
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Real-World Applications">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#enterprise-applications" class="md-nav__link">
    <span class="md-ellipsis">
      Enterprise Applications
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cloud-platforms" class="md-nav__link">
    <span class="md-ellipsis">
      Cloud Platforms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#api-security" class="md-nav__link">
    <span class="md-ellipsis">
      API Security
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#microservices-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      Microservices Architecture
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple-authentication-and-authorization-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      Simple Authentication and Authorization Implementation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#common-interview-questions" class="md-nav__link">
    <span class="md-ellipsis">
      Common Interview Questions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#authentication-and-authorization-best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      Authentication and Authorization Best Practices
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Authentication and Authorization Best Practices">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#implement-defense-in-depth" class="md-nav__link">
    <span class="md-ellipsis">
      Implement Defense in Depth
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#follow-the-principle-of-least-privilege" class="md-nav__link">
    <span class="md-ellipsis">
      Follow the Principle of Least Privilege
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#secure-token-management" class="md-nav__link">
    <span class="md-ellipsis">
      Secure Token Management
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#implement-comprehensive-auditing" class="md-nav__link">
    <span class="md-ellipsis">
      Implement Comprehensive Auditing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#plan-for-scalability-and-performance" class="md-nav__link">
    <span class="md-ellipsis">
      Plan for Scalability and Performance
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#regular-security-reviews" class="md-nav__link">
    <span class="md-ellipsis">
      Regular Security Reviews
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/Arun-Labana/backend/edit/master/docs/29. Authentication vs Authorization/README.md" title="Edit this page" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  


<h1 id="authentication-vs-authorization">Authentication vs Authorization<a class="headerlink" href="#authentication-vs-authorization" title="Permanent link">&para;</a></h1>
<h2 id="what-are-authentication-and-authorization">What are Authentication and Authorization?<a class="headerlink" href="#what-are-authentication-and-authorization" title="Permanent link">&para;</a></h2>
<p>Authentication and Authorization are two fundamental security concepts that work together to protect systems and data, but they serve distinctly different purposes. Think of authentication like showing your ID at a nightclub entrance - the bouncer needs to verify that you are who you claim to be by checking your identification. Authorization is like the VIP list that determines what areas of the club you can access once you're inside - even though you've proven your identity, you might only be allowed in certain sections based on your membership level or special privileges.</p>
<p>Authentication answers the question "Who are you?" while authorization answers "What are you allowed to do?" These concepts are often confused because they work so closely together, but understanding their differences is crucial for designing secure systems. Authentication must happen first to establish identity, and then authorization determines what that authenticated identity is permitted to access or perform.</p>
<h2 id="authentication-proving-identity">Authentication: Proving Identity<a class="headerlink" href="#authentication-proving-identity" title="Permanent link">&para;</a></h2>
<h3 id="what-authentication-accomplishes">What Authentication Accomplishes<a class="headerlink" href="#what-authentication-accomplishes" title="Permanent link">&para;</a></h3>
<p>Authentication is the process of verifying that users or systems are who they claim to be. This verification can be based on something you know (like a password), something you have (like a phone or security token), something you are (like biometric data), or a combination of these factors. The goal is to establish a trusted identity that the system can then use to make decisions about access and permissions.</p>
<p>Successful authentication creates a security context or session that represents the verified identity. This context typically includes information about the user, when they authenticated, and potentially additional metadata about their authentication method or device. This context is then used throughout the user's session to make authorization decisions without requiring repeated authentication.</p>
<h3 id="types-of-authentication">Types of Authentication<a class="headerlink" href="#types-of-authentication" title="Permanent link">&para;</a></h3>
<p><strong>Password-based authentication</strong> is the most common form, where users provide a username and password combination. While simple to implement and understand, password-based authentication has well-known vulnerabilities including password reuse, weak passwords, and susceptibility to various attacks like brute force, dictionary attacks, and credential stuffing.</p>
<p><strong>Multi-factor authentication (MFA)</strong> combines multiple authentication factors to provide stronger security. Common implementations include SMS codes, authenticator apps, hardware tokens, or biometric verification in addition to passwords. MFA significantly improves security by requiring attackers to compromise multiple independent factors.</p>
<p><strong>Single Sign-On (SSO)</strong> allows users to authenticate once and access multiple related systems without re-authenticating. SSO improves user experience while potentially strengthening security by centralizing authentication and allowing for stronger authentication methods and better monitoring.</p>
<p><strong>Certificate-based authentication</strong> uses digital certificates to verify identity, commonly used for system-to-system authentication or in high-security environments. Certificates provide strong cryptographic proof of identity and can be managed centrally through Certificate Authorities.</p>
<h3 id="authentication-challenges">Authentication Challenges<a class="headerlink" href="#authentication-challenges" title="Permanent link">&para;</a></h3>
<p>Modern authentication faces numerous challenges including credential management, user experience, and security threats. Users struggle with password fatigue, leading to weak passwords or password reuse across systems. Organizations must balance security requirements with usability, as overly complex authentication processes can lead to user frustration and workarounds that actually reduce security.</p>
<p>Distributed systems add complexity to authentication, requiring secure token management, session handling across services, and consistent authentication policies. Mobile and IoT devices introduce additional challenges around device trust, certificate management, and handling intermittent connectivity.</p>
<h2 id="authorization-controlling-access">Authorization: Controlling Access<a class="headerlink" href="#authorization-controlling-access" title="Permanent link">&para;</a></h2>
<h3 id="what-authorization-accomplishes">What Authorization Accomplishes<a class="headerlink" href="#what-authorization-accomplishes" title="Permanent link">&para;</a></h3>
<p>Authorization determines what authenticated users are allowed to do within a system. This includes access to specific resources, permission to perform certain operations, and the scope of data they can view or modify. Authorization policies are typically based on the user's role, attributes, or relationship to the requested resource.</p>
<p>Effective authorization systems provide fine-grained control over system access while remaining manageable and understandable. They must handle complex scenarios like hierarchical permissions, temporary access grants, and context-dependent access rules while maintaining good performance and auditability.</p>
<h3 id="authorization-models">Authorization Models<a class="headerlink" href="#authorization-models" title="Permanent link">&para;</a></h3>
<p><strong>Role-Based Access Control (RBAC)</strong> assigns permissions to roles rather than individual users, and users are assigned to one or more roles. This model simplifies permission management by grouping related permissions together and allowing administrators to manage access by assigning appropriate roles to users. RBAC works well for organizations with clear hierarchical structures and well-defined job functions.</p>
<p><strong>Attribute-Based Access Control (ABAC)</strong> makes authorization decisions based on attributes of the user, resource, action, and environment. This model provides more flexibility than RBAC by allowing complex policies that consider multiple factors like time of day, user location, resource sensitivity, and current security context. ABAC is more complex to implement but can handle sophisticated authorization requirements.</p>
<p><strong>Access Control Lists (ACLs)</strong> specify which users or groups have what permissions on specific resources. ACLs provide direct, resource-centric access control but can become difficult to manage at scale. They're often used for file systems and simple resource protection scenarios.</p>
<p><strong>Policy-Based Access Control</strong> uses externalized policy engines to make authorization decisions based on complex rules and policies. This approach separates authorization logic from application code, making it easier to manage and audit access policies across multiple systems.</p>
<h3 id="authorization-enforcement">Authorization Enforcement<a class="headerlink" href="#authorization-enforcement" title="Permanent link">&para;</a></h3>
<p>Authorization can be enforced at multiple layers within a system architecture. <strong>Application-level authorization</strong> is implemented within the application code and provides fine-grained control over business logic and data access. This approach offers maximum flexibility but requires careful implementation to avoid security gaps.</p>
<p><strong>Infrastructure-level authorization</strong> is enforced by network devices, load balancers, or API gateways before requests reach applications. This provides a security perimeter and can block unauthorized requests early, but may lack the context needed for fine-grained decisions.</p>
<p><strong>Database-level authorization</strong> controls access to data at the storage layer through database permissions and row-level security. This provides a final layer of protection but may not align well with application-level business rules.</p>
<h2 id="the-relationship-between-authentication-and-authorization">The Relationship Between Authentication and Authorization<a class="headerlink" href="#the-relationship-between-authentication-and-authorization" title="Permanent link">&para;</a></h2>
<h3 id="sequential-dependency">Sequential Dependency<a class="headerlink" href="#sequential-dependency" title="Permanent link">&para;</a></h3>
<p>Authentication must precede authorization in the security flow. You cannot determine what someone is allowed to do until you know who they are. However, the strength of authentication affects the trust level for authorization decisions. Stronger authentication methods might grant access to more sensitive resources or operations.</p>
<p>Some systems implement step-up authentication, where certain high-privilege operations require additional authentication even within an existing session. This allows for graduated access based on authentication strength and recency.</p>
<h3 id="token-based-integration">Token-Based Integration<a class="headerlink" href="#token-based-integration" title="Permanent link">&para;</a></h3>
<p>Modern systems often use tokens to bridge authentication and authorization. After successful authentication, the system issues a token that contains identity information and potentially authorization claims. This token is then presented with each request, allowing the system to make both authentication (is this token valid?) and authorization (what does this token allow?) decisions.</p>
<p>Tokens can be opaque references that require server-side lookup, or self-contained tokens like JWTs that include encoded claims. The choice affects performance, scalability, and security characteristics of the system.</p>
<h2 id="real-world-applications">Real-World Applications<a class="headerlink" href="#real-world-applications" title="Permanent link">&para;</a></h2>
<h3 id="enterprise-applications">Enterprise Applications<a class="headerlink" href="#enterprise-applications" title="Permanent link">&para;</a></h3>
<p>Large organizations typically implement comprehensive identity and access management (IAM) systems that handle both authentication and authorization across multiple applications. Employees authenticate once through SSO and receive access to various systems based on their roles and departments.</p>
<p>These systems often integrate with directory services like Active Directory, implement approval workflows for access requests, and provide detailed audit trails for compliance requirements. They must handle complex scenarios like temporary access for contractors, emergency access procedures, and automated access provisioning based on HR systems.</p>
<h3 id="cloud-platforms">Cloud Platforms<a class="headerlink" href="#cloud-platforms" title="Permanent link">&para;</a></h3>
<p>Cloud providers like AWS, Azure, and Google Cloud implement sophisticated IAM systems that control access to cloud resources. Users and services authenticate using various methods (passwords, API keys, certificates, federated identity), and authorization is controlled through policies that specify which resources can be accessed and what operations are permitted.</p>
<p>These systems must handle massive scale, complex resource hierarchies, and integration with customer identity systems while providing fine-grained control and comprehensive audit capabilities.</p>
<h3 id="api-security">API Security<a class="headerlink" href="#api-security" title="Permanent link">&para;</a></h3>
<p>APIs use authentication to verify client identity (through API keys, OAuth tokens, or certificates) and authorization to control which endpoints and data each client can access. Rate limiting, quota management, and usage analytics are often integrated with the authorization system.</p>
<p>Modern API security often implements OAuth 2.0 flows that separate authentication (handled by identity providers) from authorization (controlled by resource servers), allowing for flexible integration patterns and third-party access scenarios.</p>
<h3 id="microservices-architecture">Microservices Architecture<a class="headerlink" href="#microservices-architecture" title="Permanent link">&para;</a></h3>
<p>Distributed microservices require careful coordination of authentication and authorization across service boundaries. Common patterns include using API gateways for authentication and passing identity context between services, implementing service-to-service authentication through certificates or service accounts, and using distributed authorization systems that can make consistent decisions across all services.</p>
<h2 id="simple-authentication-and-authorization-implementation">Simple Authentication and Authorization Implementation<a class="headerlink" href="#simple-authentication-and-authorization-implementation" title="Permanent link">&para;</a></h2>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">hashlib</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">hmac</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">jwt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Set</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">enum</span><span class="w"> </span><span class="kn">import</span> <span class="n">Enum</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>

<span class="k">class</span><span class="w"> </span><span class="nc">Role</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="n">ADMIN</span> <span class="o">=</span> <span class="s2">&quot;admin&quot;</span>
    <span class="n">USER</span> <span class="o">=</span> <span class="s2">&quot;user&quot;</span>
    <span class="n">GUEST</span> <span class="o">=</span> <span class="s2">&quot;guest&quot;</span>

<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">User</span><span class="p">:</span>
    <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">username</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">password_hash</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">roles</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="n">Role</span><span class="p">]</span>
    <span class="n">email</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">created_at</span><span class="p">:</span> <span class="n">datetime</span>
    <span class="n">last_login</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">is_active</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>

<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Permission</span><span class="p">:</span>
    <span class="n">resource</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">action</span><span class="p">:</span> <span class="nb">str</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">action</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">resource</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">AuthToken</span><span class="p">:</span>
    <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">username</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">roles</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">issued_at</span><span class="p">:</span> <span class="n">datetime</span>
    <span class="n">expires_at</span><span class="p">:</span> <span class="n">datetime</span>

<span class="k">class</span><span class="w"> </span><span class="nc">AuthenticationService</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">secret_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">secret_key</span> <span class="o">=</span> <span class="n">secret_key</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">users</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">User</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sessions</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">AuthToken</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">failed_attempts</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">datetime</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_failed_attempts</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lockout_duration</span> <span class="o">=</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">minutes</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_hash_password</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">password</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">salt</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Hash password with salt&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">salt</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">salt</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">())</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()[:</span><span class="mi">16</span><span class="p">]</span>

        <span class="n">password_hash</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">pbkdf2_hmac</span><span class="p">(</span><span class="s1">&#39;sha256&#39;</span><span class="p">,</span> 
                                          <span class="n">password</span><span class="o">.</span><span class="n">encode</span><span class="p">(),</span> 
                                          <span class="n">salt</span><span class="o">.</span><span class="n">encode</span><span class="p">(),</span> 
                                          <span class="mi">100000</span><span class="p">)</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">salt</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">password_hash</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_verify_password</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">password</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">password_hash</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Verify password against hash&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">salt</span><span class="p">,</span> <span class="n">hash_hex</span> <span class="o">=</span> <span class="n">password_hash</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
            <span class="n">expected_hash</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">pbkdf2_hmac</span><span class="p">(</span><span class="s1">&#39;sha256&#39;</span><span class="p">,</span>
                                              <span class="n">password</span><span class="o">.</span><span class="n">encode</span><span class="p">(),</span>
                                              <span class="n">salt</span><span class="o">.</span><span class="n">encode</span><span class="p">(),</span>
                                              <span class="mi">100000</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">hmac</span><span class="o">.</span><span class="n">compare_digest</span><span class="p">(</span><span class="n">expected_hash</span><span class="o">.</span><span class="n">hex</span><span class="p">(),</span> <span class="n">hash_hex</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_is_account_locked</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">username</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if account is locked due to failed attempts&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">username</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">failed_attempts</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="n">recent_failures</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">attempt</span> <span class="k">for</span> <span class="n">attempt</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">failed_attempts</span><span class="p">[</span><span class="n">username</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="n">attempt</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">lockout_duration</span>
        <span class="p">]</span>

        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">recent_failures</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_failed_attempts</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_record_failed_attempt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">username</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Record failed authentication attempt&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">username</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">failed_attempts</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">failed_attempts</span><span class="p">[</span><span class="n">username</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">failed_attempts</span><span class="p">[</span><span class="n">username</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">())</span>

        <span class="c1"># Clean up old attempts</span>
        <span class="n">cutoff</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">lockout_duration</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">failed_attempts</span><span class="p">[</span><span class="n">username</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">attempt</span> <span class="k">for</span> <span class="n">attempt</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">failed_attempts</span><span class="p">[</span><span class="n">username</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">attempt</span> <span class="o">&gt;</span> <span class="n">cutoff</span>
        <span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">register_user</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">username</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">password</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">email</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> 
                     <span class="n">roles</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="n">Role</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Register a new user&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">username</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">users</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">roles</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">roles</span> <span class="o">=</span> <span class="p">{</span><span class="n">Role</span><span class="o">.</span><span class="n">USER</span><span class="p">}</span>

        <span class="n">password_hash</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hash_password</span><span class="p">(</span><span class="n">password</span><span class="p">)</span>

        <span class="n">user</span> <span class="o">=</span> <span class="n">User</span><span class="p">(</span>
            <span class="n">user_id</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;user_</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">users</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">username</span><span class="o">=</span><span class="n">username</span><span class="p">,</span>
            <span class="n">password_hash</span><span class="o">=</span><span class="n">password_hash</span><span class="p">,</span>
            <span class="n">roles</span><span class="o">=</span><span class="n">roles</span><span class="p">,</span>
            <span class="n">email</span><span class="o">=</span><span class="n">email</span><span class="p">,</span>
            <span class="n">created_at</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">users</span><span class="p">[</span><span class="n">username</span><span class="p">]</span> <span class="o">=</span> <span class="n">user</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;User </span><span class="si">{</span><span class="n">username</span><span class="si">}</span><span class="s2"> registered successfully&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">authenticate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">username</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">password</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Authenticate user and return token&quot;&quot;&quot;</span>
        <span class="c1"># Check if account is locked</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_account_locked</span><span class="p">(</span><span class="n">username</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Authentication failed: Account </span><span class="si">{</span><span class="n">username</span><span class="si">}</span><span class="s2"> is locked&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="c1"># Check if user exists</span>
        <span class="k">if</span> <span class="n">username</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">users</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_record_failed_attempt</span><span class="p">(</span><span class="n">username</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Authentication failed: User </span><span class="si">{</span><span class="n">username</span><span class="si">}</span><span class="s2"> not found&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="n">user</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">users</span><span class="p">[</span><span class="n">username</span><span class="p">]</span>

        <span class="c1"># Check if user is active</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">user</span><span class="o">.</span><span class="n">is_active</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Authentication failed: User </span><span class="si">{</span><span class="n">username</span><span class="si">}</span><span class="s2"> is inactive&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="c1"># Verify password</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_verify_password</span><span class="p">(</span><span class="n">password</span><span class="p">,</span> <span class="n">user</span><span class="o">.</span><span class="n">password_hash</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_record_failed_attempt</span><span class="p">(</span><span class="n">username</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Authentication failed: Invalid password for </span><span class="si">{</span><span class="n">username</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="c1"># Clear failed attempts on successful login</span>
        <span class="k">if</span> <span class="n">username</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">failed_attempts</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">failed_attempts</span><span class="p">[</span><span class="n">username</span><span class="p">]</span>

        <span class="c1"># Update last login</span>
        <span class="n">user</span><span class="o">.</span><span class="n">last_login</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>

        <span class="c1"># Generate token</span>
        <span class="n">token_data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;user_id&#39;</span><span class="p">:</span> <span class="n">user</span><span class="o">.</span><span class="n">user_id</span><span class="p">,</span>
            <span class="s1">&#39;username&#39;</span><span class="p">:</span> <span class="n">user</span><span class="o">.</span><span class="n">username</span><span class="p">,</span>
            <span class="s1">&#39;roles&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">role</span><span class="o">.</span><span class="n">value</span> <span class="k">for</span> <span class="n">role</span> <span class="ow">in</span> <span class="n">user</span><span class="o">.</span><span class="n">roles</span><span class="p">],</span>
            <span class="s1">&#39;iat&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(),</span>
            <span class="s1">&#39;exp&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">+</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
        <span class="p">}</span>

        <span class="n">token</span> <span class="o">=</span> <span class="n">jwt</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">token_data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">secret_key</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;HS256&#39;</span><span class="p">)</span>

        <span class="c1"># Store session</span>
        <span class="n">auth_token</span> <span class="o">=</span> <span class="n">AuthToken</span><span class="p">(</span>
            <span class="n">user_id</span><span class="o">=</span><span class="n">user</span><span class="o">.</span><span class="n">user_id</span><span class="p">,</span>
            <span class="n">username</span><span class="o">=</span><span class="n">user</span><span class="o">.</span><span class="n">username</span><span class="p">,</span>
            <span class="n">roles</span><span class="o">=</span><span class="p">[</span><span class="n">role</span><span class="o">.</span><span class="n">value</span> <span class="k">for</span> <span class="n">role</span> <span class="ow">in</span> <span class="n">user</span><span class="o">.</span><span class="n">roles</span><span class="p">],</span>
            <span class="n">issued_at</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(),</span>
            <span class="n">expires_at</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">+</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">sessions</span><span class="p">[</span><span class="n">token</span><span class="p">]</span> <span class="o">=</span> <span class="n">auth_token</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;User </span><span class="si">{</span><span class="n">username</span><span class="si">}</span><span class="s2"> authenticated successfully&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">token</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">validate_token</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">token</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">AuthToken</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Validate authentication token&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Decode JWT</span>
            <span class="n">payload</span> <span class="o">=</span> <span class="n">jwt</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">token</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">secret_key</span><span class="p">,</span> <span class="n">algorithms</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;HS256&#39;</span><span class="p">])</span>

            <span class="c1"># Check if session exists</span>
            <span class="k">if</span> <span class="n">token</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sessions</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span>

            <span class="n">auth_token</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sessions</span><span class="p">[</span><span class="n">token</span><span class="p">]</span>

            <span class="c1"># Check if token is expired</span>
            <span class="k">if</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">&gt;</span> <span class="n">auth_token</span><span class="o">.</span><span class="n">expires_at</span><span class="p">:</span>
                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">sessions</span><span class="p">[</span><span class="n">token</span><span class="p">]</span>
                <span class="k">return</span> <span class="kc">None</span>

            <span class="k">return</span> <span class="n">auth_token</span>

        <span class="k">except</span> <span class="n">jwt</span><span class="o">.</span><span class="n">InvalidTokenError</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">logout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">token</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Logout user by invalidating token&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">token</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sessions</span><span class="p">:</span>
            <span class="n">username</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sessions</span><span class="p">[</span><span class="n">token</span><span class="p">]</span><span class="o">.</span><span class="n">username</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">sessions</span><span class="p">[</span><span class="n">token</span><span class="p">]</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;User </span><span class="si">{</span><span class="n">username</span><span class="si">}</span><span class="s2"> logged out&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span>

<span class="k">class</span><span class="w"> </span><span class="nc">AuthorizationService</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Define role-based permissions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">role_permissions</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Role</span><span class="p">,</span> <span class="n">Set</span><span class="p">[</span><span class="n">Permission</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">Role</span><span class="o">.</span><span class="n">ADMIN</span><span class="p">:</span> <span class="p">{</span>
                <span class="n">Permission</span><span class="p">(</span><span class="s2">&quot;users&quot;</span><span class="p">,</span> <span class="s2">&quot;create&quot;</span><span class="p">),</span>
                <span class="n">Permission</span><span class="p">(</span><span class="s2">&quot;users&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">),</span>
                <span class="n">Permission</span><span class="p">(</span><span class="s2">&quot;users&quot;</span><span class="p">,</span> <span class="s2">&quot;update&quot;</span><span class="p">),</span>
                <span class="n">Permission</span><span class="p">(</span><span class="s2">&quot;users&quot;</span><span class="p">,</span> <span class="s2">&quot;delete&quot;</span><span class="p">),</span>
                <span class="n">Permission</span><span class="p">(</span><span class="s2">&quot;posts&quot;</span><span class="p">,</span> <span class="s2">&quot;create&quot;</span><span class="p">),</span>
                <span class="n">Permission</span><span class="p">(</span><span class="s2">&quot;posts&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">),</span>
                <span class="n">Permission</span><span class="p">(</span><span class="s2">&quot;posts&quot;</span><span class="p">,</span> <span class="s2">&quot;update&quot;</span><span class="p">),</span>
                <span class="n">Permission</span><span class="p">(</span><span class="s2">&quot;posts&quot;</span><span class="p">,</span> <span class="s2">&quot;delete&quot;</span><span class="p">),</span>
                <span class="n">Permission</span><span class="p">(</span><span class="s2">&quot;system&quot;</span><span class="p">,</span> <span class="s2">&quot;configure&quot;</span><span class="p">),</span>
            <span class="p">},</span>
            <span class="n">Role</span><span class="o">.</span><span class="n">USER</span><span class="p">:</span> <span class="p">{</span>
                <span class="n">Permission</span><span class="p">(</span><span class="s2">&quot;posts&quot;</span><span class="p">,</span> <span class="s2">&quot;create&quot;</span><span class="p">),</span>
                <span class="n">Permission</span><span class="p">(</span><span class="s2">&quot;posts&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">),</span>
                <span class="n">Permission</span><span class="p">(</span><span class="s2">&quot;posts&quot;</span><span class="p">,</span> <span class="s2">&quot;update_own&quot;</span><span class="p">),</span>
                <span class="n">Permission</span><span class="p">(</span><span class="s2">&quot;posts&quot;</span><span class="p">,</span> <span class="s2">&quot;delete_own&quot;</span><span class="p">),</span>
                <span class="n">Permission</span><span class="p">(</span><span class="s2">&quot;profile&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">),</span>
                <span class="n">Permission</span><span class="p">(</span><span class="s2">&quot;profile&quot;</span><span class="p">,</span> <span class="s2">&quot;update&quot;</span><span class="p">),</span>
            <span class="p">},</span>
            <span class="n">Role</span><span class="o">.</span><span class="n">GUEST</span><span class="p">:</span> <span class="p">{</span>
                <span class="n">Permission</span><span class="p">(</span><span class="s2">&quot;posts&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">),</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="c1"># Resource ownership tracking</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resource_owners</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">has_permission</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">auth_token</span><span class="p">:</span> <span class="n">AuthToken</span><span class="p">,</span> <span class="n">resource</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">action</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> 
                      <span class="n">resource_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if user has permission for specific action on resource&quot;&quot;&quot;</span>
        <span class="n">user_permissions</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

        <span class="c1"># Collect permissions from all user roles</span>
        <span class="k">for</span> <span class="n">role_str</span> <span class="ow">in</span> <span class="n">auth_token</span><span class="o">.</span><span class="n">roles</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">role</span> <span class="o">=</span> <span class="n">Role</span><span class="p">(</span><span class="n">role_str</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">role</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">role_permissions</span><span class="p">:</span>
                    <span class="n">user_permissions</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">role_permissions</span><span class="p">[</span><span class="n">role</span><span class="p">])</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">continue</span>

        <span class="c1"># Check for exact permission match</span>
        <span class="n">required_permission</span> <span class="o">=</span> <span class="n">Permission</span><span class="p">(</span><span class="n">resource</span><span class="p">,</span> <span class="n">action</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">required_permission</span> <span class="ow">in</span> <span class="n">user_permissions</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>

        <span class="c1"># Check for ownership-based permissions</span>
        <span class="k">if</span> <span class="n">resource_id</span> <span class="ow">and</span> <span class="n">action</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;_own&#39;</span><span class="p">):</span>
            <span class="n">base_action</span> <span class="o">=</span> <span class="n">action</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_own&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="n">ownership_permission</span> <span class="o">=</span> <span class="n">Permission</span><span class="p">(</span><span class="n">resource</span><span class="p">,</span> <span class="n">base_action</span> <span class="o">+</span> <span class="s1">&#39;_own&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">ownership_permission</span> <span class="ow">in</span> <span class="n">user_permissions</span><span class="p">:</span>
                <span class="c1"># Check if user owns the resource</span>
                <span class="n">resource_key</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">resource</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">resource_id</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">resource_owners</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">resource_key</span><span class="p">)</span> <span class="o">==</span> <span class="n">auth_token</span><span class="o">.</span><span class="n">user_id</span>

        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_resource_owner</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">resource_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">owner_user_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set ownership of a resource&quot;&quot;&quot;</span>
        <span class="n">resource_key</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">resource</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">resource_id</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resource_owners</span><span class="p">[</span><span class="n">resource_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">owner_user_id</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_user_permissions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">auth_token</span><span class="p">:</span> <span class="n">AuthToken</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Set</span><span class="p">[</span><span class="n">Permission</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get all permissions for a user&quot;&quot;&quot;</span>
        <span class="n">user_permissions</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">role_str</span> <span class="ow">in</span> <span class="n">auth_token</span><span class="o">.</span><span class="n">roles</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">role</span> <span class="o">=</span> <span class="n">Role</span><span class="p">(</span><span class="n">role_str</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">role</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">role_permissions</span><span class="p">:</span>
                    <span class="n">user_permissions</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">role_permissions</span><span class="p">[</span><span class="n">role</span><span class="p">])</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">continue</span>

        <span class="k">return</span> <span class="n">user_permissions</span>

<span class="c1"># Demonstration of authentication and authorization</span>
<span class="k">def</span><span class="w"> </span><span class="nf">demo_auth_system</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== Authentication &amp; Authorization Demo ===&quot;</span><span class="p">)</span>

    <span class="c1"># Initialize services</span>
    <span class="n">auth_service</span> <span class="o">=</span> <span class="n">AuthenticationService</span><span class="p">(</span><span class="s2">&quot;secret_key_123&quot;</span><span class="p">)</span>
    <span class="n">authz_service</span> <span class="o">=</span> <span class="n">AuthorizationService</span><span class="p">()</span>

    <span class="c1"># Register users</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">=== User Registration ===&quot;</span><span class="p">)</span>
    <span class="n">auth_service</span><span class="o">.</span><span class="n">register_user</span><span class="p">(</span><span class="s2">&quot;admin&quot;</span><span class="p">,</span> <span class="s2">&quot;admin_pass&quot;</span><span class="p">,</span> <span class="s2">&quot;admin@example.com&quot;</span><span class="p">,</span> <span class="p">{</span><span class="n">Role</span><span class="o">.</span><span class="n">ADMIN</span><span class="p">})</span>
    <span class="n">auth_service</span><span class="o">.</span><span class="n">register_user</span><span class="p">(</span><span class="s2">&quot;john&quot;</span><span class="p">,</span> <span class="s2">&quot;john_pass&quot;</span><span class="p">,</span> <span class="s2">&quot;john@example.com&quot;</span><span class="p">,</span> <span class="p">{</span><span class="n">Role</span><span class="o">.</span><span class="n">USER</span><span class="p">})</span>
    <span class="n">auth_service</span><span class="o">.</span><span class="n">register_user</span><span class="p">(</span><span class="s2">&quot;guest&quot;</span><span class="p">,</span> <span class="s2">&quot;guest_pass&quot;</span><span class="p">,</span> <span class="s2">&quot;guest@example.com&quot;</span><span class="p">,</span> <span class="p">{</span><span class="n">Role</span><span class="o">.</span><span class="n">GUEST</span><span class="p">})</span>

    <span class="c1"># Test authentication</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">=== Authentication Tests ===&quot;</span><span class="p">)</span>

    <span class="c1"># Successful authentication</span>
    <span class="n">admin_token</span> <span class="o">=</span> <span class="n">auth_service</span><span class="o">.</span><span class="n">authenticate</span><span class="p">(</span><span class="s2">&quot;admin&quot;</span><span class="p">,</span> <span class="s2">&quot;admin_pass&quot;</span><span class="p">)</span>
    <span class="n">john_token</span> <span class="o">=</span> <span class="n">auth_service</span><span class="o">.</span><span class="n">authenticate</span><span class="p">(</span><span class="s2">&quot;john&quot;</span><span class="p">,</span> <span class="s2">&quot;john_pass&quot;</span><span class="p">)</span>
    <span class="n">guest_token</span> <span class="o">=</span> <span class="n">auth_service</span><span class="o">.</span><span class="n">authenticate</span><span class="p">(</span><span class="s2">&quot;guest&quot;</span><span class="p">,</span> <span class="s2">&quot;guest_pass&quot;</span><span class="p">)</span>

    <span class="c1"># Failed authentication</span>
    <span class="n">failed_token</span> <span class="o">=</span> <span class="n">auth_service</span><span class="o">.</span><span class="n">authenticate</span><span class="p">(</span><span class="s2">&quot;john&quot;</span><span class="p">,</span> <span class="s2">&quot;wrong_pass&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed auth result: </span><span class="si">{</span><span class="n">failed_token</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Test authorization</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">=== Authorization Tests ===&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">admin_token</span><span class="p">:</span>
        <span class="n">admin_auth</span> <span class="o">=</span> <span class="n">auth_service</span><span class="o">.</span><span class="n">validate_token</span><span class="p">(</span><span class="n">admin_token</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">admin_auth</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Admin permissions:&quot;</span><span class="p">)</span>
            <span class="n">permissions</span> <span class="o">=</span> <span class="n">authz_service</span><span class="o">.</span><span class="n">get_user_permissions</span><span class="p">(</span><span class="n">admin_auth</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">perm</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">permissions</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="nb">str</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  - </span><span class="si">{</span><span class="n">perm</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="c1"># Test admin permissions</span>
            <span class="n">can_delete_users</span> <span class="o">=</span> <span class="n">authz_service</span><span class="o">.</span><span class="n">has_permission</span><span class="p">(</span><span class="n">admin_auth</span><span class="p">,</span> <span class="s2">&quot;users&quot;</span><span class="p">,</span> <span class="s2">&quot;delete&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Admin can delete users: </span><span class="si">{</span><span class="n">can_delete_users</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">john_token</span><span class="p">:</span>
        <span class="n">john_auth</span> <span class="o">=</span> <span class="n">auth_service</span><span class="o">.</span><span class="n">validate_token</span><span class="p">(</span><span class="n">john_token</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">john_auth</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">John permissions:&quot;</span><span class="p">)</span>
            <span class="n">permissions</span> <span class="o">=</span> <span class="n">authz_service</span><span class="o">.</span><span class="n">get_user_permissions</span><span class="p">(</span><span class="n">john_auth</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">perm</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">permissions</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="nb">str</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  - </span><span class="si">{</span><span class="n">perm</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="c1"># Test user permissions</span>
            <span class="n">can_read_posts</span> <span class="o">=</span> <span class="n">authz_service</span><span class="o">.</span><span class="n">has_permission</span><span class="p">(</span><span class="n">john_auth</span><span class="p">,</span> <span class="s2">&quot;posts&quot;</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">)</span>
            <span class="n">can_delete_users</span> <span class="o">=</span> <span class="n">authz_service</span><span class="o">.</span><span class="n">has_permission</span><span class="p">(</span><span class="n">john_auth</span><span class="p">,</span> <span class="s2">&quot;users&quot;</span><span class="p">,</span> <span class="s2">&quot;delete&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;John can read posts: </span><span class="si">{</span><span class="n">can_read_posts</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;John can delete users: </span><span class="si">{</span><span class="n">can_delete_users</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="c1"># Test ownership-based permissions</span>
            <span class="n">authz_service</span><span class="o">.</span><span class="n">set_resource_owner</span><span class="p">(</span><span class="s2">&quot;posts&quot;</span><span class="p">,</span> <span class="s2">&quot;123&quot;</span><span class="p">,</span> <span class="n">john_auth</span><span class="o">.</span><span class="n">user_id</span><span class="p">)</span>
            <span class="n">can_update_own_post</span> <span class="o">=</span> <span class="n">authz_service</span><span class="o">.</span><span class="n">has_permission</span><span class="p">(</span><span class="n">john_auth</span><span class="p">,</span> <span class="s2">&quot;posts&quot;</span><span class="p">,</span> <span class="s2">&quot;update_own&quot;</span><span class="p">,</span> <span class="s2">&quot;123&quot;</span><span class="p">)</span>
            <span class="n">can_update_other_post</span> <span class="o">=</span> <span class="n">authz_service</span><span class="o">.</span><span class="n">has_permission</span><span class="p">(</span><span class="n">john_auth</span><span class="p">,</span> <span class="s2">&quot;posts&quot;</span><span class="p">,</span> <span class="s2">&quot;update_own&quot;</span><span class="p">,</span> <span class="s2">&quot;456&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;John can update own post: </span><span class="si">{</span><span class="n">can_update_own_post</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;John can update other&#39;s post: </span><span class="si">{</span><span class="n">can_update_other_post</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Test token validation and logout</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">=== Session Management ===&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">john_token</span><span class="p">:</span>
        <span class="n">valid_token</span> <span class="o">=</span> <span class="n">auth_service</span><span class="o">.</span><span class="n">validate_token</span><span class="p">(</span><span class="n">john_token</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Token valid before logout: </span><span class="si">{</span><span class="n">valid_token</span><span class="w"> </span><span class="ow">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="kc">None</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">auth_service</span><span class="o">.</span><span class="n">logout</span><span class="p">(</span><span class="n">john_token</span><span class="p">)</span>

        <span class="n">valid_token</span> <span class="o">=</span> <span class="n">auth_service</span><span class="o">.</span><span class="n">validate_token</span><span class="p">(</span><span class="n">john_token</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Token valid after logout: </span><span class="si">{</span><span class="n">valid_token</span><span class="w"> </span><span class="ow">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="kc">None</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">demo_auth_system</span><span class="p">()</span>
</code></pre></div>

<h2 id="common-interview-questions">Common Interview Questions<a class="headerlink" href="#common-interview-questions" title="Permanent link">&para;</a></h2>
<p><strong>Q: What's the difference between authentication and authorization?</strong></p>
<p>Authentication verifies identity ("Who are you?") while authorization controls access ("What can you do?"). Authentication comes first - you must prove who you are before the system can determine what you're allowed to access. Authentication methods include passwords, multi-factor authentication, certificates, or biometrics. Authorization uses that verified identity to make access decisions based on roles, permissions, or policies. For example, logging into a banking app is authentication, while being able to view only your own accounts (not others') is authorization. You can't have authorization without authentication, but you can authenticate without being authorized for specific resources.</p>
<p><strong>Q: What are the different types of authentication methods and their trade-offs?</strong></p>
<p>Password-based: Simple but vulnerable to attacks, password reuse, and user fatigue. Multi-factor authentication (MFA): Much more secure by combining multiple factors (something you know/have/are) but adds complexity and potential user friction. Single Sign-On (SSO): Improves user experience and can strengthen security through centralization, but creates single points of failure. Certificate-based: Very secure and good for system-to-system auth, but complex to manage and deploy. Biometric: Convenient and secure, but requires special hardware and raises privacy concerns. The choice depends on security requirements, user experience needs, technical constraints, and compliance requirements.</p>
<p><strong>Q: Explain Role-Based Access Control (RBAC) vs Attribute-Based Access Control (ABAC).</strong></p>
<p>RBAC assigns permissions to roles, then assigns users to roles. It's simple to understand and manage, works well for hierarchical organizations, and provides good separation of duties. However, it can become rigid and create role explosion in complex scenarios. ABAC makes decisions based on attributes of users, resources, actions, and environment (time, location, etc.). It's much more flexible and can handle complex policies, but is harder to implement, debug, and audit. RBAC is better for stable, well-defined organizational structures, while ABAC suits dynamic environments with complex access requirements. Many modern systems use hybrid approaches combining both models.</p>
<p><strong>Q: How do you implement secure session management in distributed systems?</strong></p>
<p>Secure session management in distributed systems involves several strategies: Use stateless tokens (like JWTs) that contain necessary information and can be validated without server-side storage, but ensure proper token expiration and rotation. Implement distributed session stores (Redis, database) that all services can access for stateful sessions. Use secure token transmission (HTTPS only, secure cookies, proper headers). Implement token refresh mechanisms to limit exposure time. Handle token revocation through blacklists or short expiration times. Consider service-to-service authentication using certificates or service accounts. Implement proper logout that invalidates tokens across all services. Monitor for suspicious activity and implement rate limiting to prevent abuse.</p>
<h2 id="authentication-and-authorization-best-practices">Authentication and Authorization Best Practices<a class="headerlink" href="#authentication-and-authorization-best-practices" title="Permanent link">&para;</a></h2>
<h3 id="implement-defense-in-depth">Implement Defense in Depth<a class="headerlink" href="#implement-defense-in-depth" title="Permanent link">&para;</a></h3>
<p>Use multiple layers of security rather than relying on a single authentication or authorization mechanism. Combine strong authentication with fine-grained authorization, implement both application-level and infrastructure-level controls, and use monitoring and anomaly detection to identify potential security issues.</p>
<h3 id="follow-the-principle-of-least-privilege">Follow the Principle of Least Privilege<a class="headerlink" href="#follow-the-principle-of-least-privilege" title="Permanent link">&para;</a></h3>
<p>Grant users and systems only the minimum permissions necessary to perform their required functions. Regularly review and audit permissions, implement time-limited access for temporary needs, and use role hierarchies to manage permissions efficiently while avoiding over-privileging.</p>
<h3 id="secure-token-management">Secure Token Management<a class="headerlink" href="#secure-token-management" title="Permanent link">&para;</a></h3>
<p>Use secure token generation with sufficient entropy, implement proper token expiration and rotation policies, transmit tokens only over secure channels, and store tokens securely on both client and server sides. Consider the trade-offs between stateful and stateless tokens based on your scalability and security requirements.</p>
<h3 id="implement-comprehensive-auditing">Implement Comprehensive Auditing<a class="headerlink" href="#implement-comprehensive-auditing" title="Permanent link">&para;</a></h3>
<p>Log all authentication and authorization events including successful and failed attempts, permission changes, and administrative actions. Ensure logs are tamper-proof, regularly monitored, and retained according to compliance requirements. Use structured logging to enable effective analysis and alerting.</p>
<h3 id="plan-for-scalability-and-performance">Plan for Scalability and Performance<a class="headerlink" href="#plan-for-scalability-and-performance" title="Permanent link">&para;</a></h3>
<p>Design authentication and authorization systems that can handle your expected load without becoming bottlenecks. Use caching appropriately, implement efficient permission lookup mechanisms, and consider the performance impact of complex authorization policies. Plan for horizontal scaling of identity and access management components.</p>
<h3 id="regular-security-reviews">Regular Security Reviews<a class="headerlink" href="#regular-security-reviews" title="Permanent link">&para;</a></h3>
<p>Conduct regular reviews of authentication mechanisms, authorization policies, and access patterns. Test for common vulnerabilities, review user permissions and role assignments, and ensure that security policies align with current business requirements and threat landscape.</p>
<p>Understanding the distinction between authentication and authorization is fundamental to building secure systems. While they work together to protect resources, each serves a specific purpose and requires different implementation strategies and security considerations. Proper implementation of both is essential for maintaining system security while providing appropriate access to legitimate users.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["navigation.instant", "navigation.sections", "navigation.tracking", "content.code.copy", "content.action.edit", "search.suggest", "search.highlight"], "search": "../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.92b07e13.min.js"></script>
      
    
  </body>
</html>